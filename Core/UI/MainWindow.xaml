<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="M365 Multi-Tenant Manager"
    Height="800"
    Width="1200"
    MinHeight="600"
    MinWidth="900"
    WindowStartupLocation="CenterScreen"
    Background="#F5F5F5">
    
    <Window.Resources>
        <!-- Color Scheme -->
        <SolidColorBrush x:Key="PrimaryColor" Color="#1B4F72"/>
        <SolidColorBrush x:Key="SecondaryColor" Color="#2874A6"/>
        <SolidColorBrush x:Key="AccentColor" Color="#3498DB"/>
        <SolidColorBrush x:Key="SuccessColor" Color="#27AE60"/>
        <SolidColorBrush x:Key="WarningColor" Color="#F39C12"/>
        <SolidColorBrush x:Key="ErrorColor" Color="#E74C3C"/>
        <SolidColorBrush x:Key="BackgroundColor" Color="#F5F5F5"/>
        <SolidColorBrush x:Key="PanelColor" Color="#FFFFFF"/>
        
        <!-- Button Style -->
        <Style x:Key="PrimaryButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource PrimaryColor}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                CornerRadius="3" 
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource SecondaryColor}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        
        <!-- TreeView Item Style -->
        <Style x:Key="NavTreeItem" TargetType="TreeViewItem">
            <Setter Property="Padding" Value="5"/>
            <Setter Property="Margin" Value="0,2"/>
        </Style>
    </Window.Resources>
    
    <DockPanel>
        <!-- Top Toolbar -->
        <Border DockPanel.Dock="Top" Background="{StaticResource PrimaryColor}" Padding="10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- Logo/Title -->
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="M365" FontSize="20" FontWeight="Bold" Foreground="White" VerticalAlignment="Center"/>
                    <TextBlock Text=" Multi-Tenant Manager" FontSize="16" Foreground="#B0C4DE" VerticalAlignment="Center"/>
                </StackPanel>
                
                <!-- Tenant Selector -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center">
                    <TextBlock Text="Tenant:" Foreground="White" VerticalAlignment="Center" Margin="0,0,10,0"/>
                    <ComboBox x:Name="TenantSelector" Width="300" Height="28">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <Ellipse Width="10" Height="10" Fill="{Binding StatusColor}" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding friendlyName}" VerticalAlignment="Center"/>
                                    <TextBlock Text=" - " Foreground="Gray" VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding primaryDomain}" Foreground="Gray" FontSize="11" VerticalAlignment="Center"/>
                                </StackPanel>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                    <Button x:Name="BtnAddTenant" Content="+" Width="28" Height="28" Margin="5,0,0,0" 
                            Style="{StaticResource PrimaryButton}" ToolTip="Add Tenant"/>
                </StackPanel>
                
                <!-- Right Side Actions -->
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <Button x:Name="BtnRefresh" Content="â†» Refresh" Style="{StaticResource PrimaryButton}" Margin="0,0,10,0"/>
                    <Button x:Name="BtnSettings" Content="âš™ Settings" Style="{StaticResource PrimaryButton}"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Status Bar -->
        <Border DockPanel.Dock="Bottom" Background="#E0E0E0" Padding="10,5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock x:Name="StatusText" Grid.Column="0" Text="Ready" VerticalAlignment="Center"/>
                <TextBlock x:Name="AuthStatus" Grid.Column="1" Text="Not Connected" Foreground="Gray" Margin="0,0,20,0" VerticalAlignment="Center"/>
                <TextBlock x:Name="VersionText" Grid.Column="2" Text="v1.0.0" Foreground="Gray" VerticalAlignment="Center"/>
            </Grid>
        </Border>
        
        <!-- Main Content -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="220" MinWidth="150"/>
                <ColumnDefinition Width="3"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <!-- Left Navigation Panel -->
            <Border Grid.Column="0" Background="{StaticResource PanelColor}" Margin="5">
                <DockPanel>
                    <TextBlock DockPanel.Dock="Top" Text="Navigation" FontWeight="Bold" Padding="10" 
                               Background="{StaticResource SecondaryColor}" Foreground="White"/>
                    
                    <TreeView x:Name="NavTree" BorderThickness="0" Padding="5">
                        <TreeViewItem Header="ðŸ“Š Dashboard" Tag="Dashboard" IsExpanded="True" Style="{StaticResource NavTreeItem}"/>
                        
                        <TreeViewItem Header="ðŸ¢ Tenants" Tag="Tenants" IsExpanded="True" Style="{StaticResource NavTreeItem}">
                            <TreeViewItem Header="Overview" Tag="TenantsOverview"/>
                            <TreeViewItem Header="Health Status" Tag="TenantsHealth"/>
                            <TreeViewItem Header="Register New" Tag="TenantsRegister"/>
                        </TreeViewItem>
                        
                        <TreeViewItem Header="ðŸ‘¥ Users" Tag="Users" IsExpanded="False" Style="{StaticResource NavTreeItem}">
                            <TreeViewItem Header="All Users" Tag="UsersAll"/>
                            <TreeViewItem Header="Guest Users" Tag="UsersGuest"/>
                            <TreeViewItem Header="Disabled Users" Tag="UsersDisabled"/>
                        </TreeViewItem>
                        
                        <TreeViewItem Header="ðŸ‘ª Groups" Tag="Groups" IsExpanded="False" Style="{StaticResource NavTreeItem}">
                            <TreeViewItem Header="All Groups" Tag="GroupsAll"/>
                            <TreeViewItem Header="Security Groups" Tag="GroupsSecurity"/>
                            <TreeViewItem Header="M365 Groups" Tag="GroupsM365"/>
                        </TreeViewItem>
                        
                        <TreeViewItem Header="ðŸ“œ Licenses" Tag="Licenses" IsExpanded="False" Style="{StaticResource NavTreeItem}">
                            <TreeViewItem Header="Overview" Tag="LicensesOverview"/>
                            <TreeViewItem Header="By Tenant" Tag="LicensesByTenant"/>
                            <TreeViewItem Header="Comparison" Tag="LicensesCompare"/>
                        </TreeViewItem>
                        
                        <TreeViewItem Header="ðŸ”’ Security" Tag="Security" IsExpanded="False" Style="{StaticResource NavTreeItem}">
                            <TreeViewItem Header="Secure Score" Tag="SecureScore"/>
                            <TreeViewItem Header="Conditional Access" Tag="ConditionalAccess"/>
                            <TreeViewItem Header="Policy Comparison" Tag="PolicyCompare"/>
                        </TreeViewItem>
                        
                        <TreeViewItem Header="ðŸ“¤ Export" Tag="Export" IsExpanded="False" Style="{StaticResource NavTreeItem}">
                            <TreeViewItem Header="Export Data" Tag="ExportData"/>
                            <TreeViewItem Header="Documentation" Tag="ExportDocs"/>
                        </TreeViewItem>
                    </TreeView>
                </DockPanel>
            </Border>
            
            <!-- Splitter -->
            <GridSplitter Grid.Column="1" Width="3" HorizontalAlignment="Stretch" Background="#CCCCCC"/>
            
            <!-- Main Content Area -->
            <Border Grid.Column="2" Background="{StaticResource PanelColor}" Margin="5">
                <DockPanel>
                    <!-- Content Header -->
                    <Border DockPanel.Dock="Top" Background="{StaticResource SecondaryColor}" Padding="10">
                        <Grid>
                            <TextBlock x:Name="ContentHeader" Text="Dashboard" FontSize="16" FontWeight="Bold" Foreground="White"/>
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                                <Button x:Name="BtnExport" Content="ðŸ“¤ Export" Style="{StaticResource PrimaryButton}" Margin="0,0,5,0"/>
                                <Button x:Name="BtnHelp" Content="â“ Help" Style="{StaticResource PrimaryButton}"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                    
                    <!-- Content Panel -->
                    <Grid x:Name="ContentPanel" Margin="10">
                        <!-- Dashboard View (Default) -->
                        <Grid x:Name="DashboardView">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Summary Cards -->
                            <UniformGrid Grid.Row="0" Columns="4" Margin="0,0,0,20">
                                <Border Background="#E8F6F3" CornerRadius="5" Padding="15" Margin="5">
                                    <StackPanel>
                                        <TextBlock Text="Tenants" Foreground="Gray"/>
                                        <TextBlock x:Name="TenantCount" Text="0" FontSize="28" FontWeight="Bold" Foreground="{StaticResource PrimaryColor}"/>
                                    </StackPanel>
                                </Border>
                                <Border Background="#EBF5FB" CornerRadius="5" Padding="15" Margin="5">
                                    <StackPanel>
                                        <TextBlock Text="Total Users" Foreground="Gray"/>
                                        <TextBlock x:Name="UserCount" Text="0" FontSize="28" FontWeight="Bold" Foreground="{StaticResource SecondaryColor}"/>
                                    </StackPanel>
                                </Border>
                                <Border Background="#FEF9E7" CornerRadius="5" Padding="15" Margin="5">
                                    <StackPanel>
                                        <TextBlock Text="Licenses Used" Foreground="Gray"/>
                                        <TextBlock x:Name="LicensePercent" Text="0%" FontSize="28" FontWeight="Bold" Foreground="{StaticResource WarningColor}"/>
                                    </StackPanel>
                                </Border>
                                <Border Background="#FDEDEC" CornerRadius="5" Padding="15" Margin="5">
                                    <StackPanel>
                                        <TextBlock Text="Security Alerts" Foreground="Gray"/>
                                        <TextBlock x:Name="AlertCount" Text="0" FontSize="28" FontWeight="Bold" Foreground="{StaticResource ErrorColor}"/>
                                    </StackPanel>
                                </Border>
                            </UniformGrid>
                            
                            <!-- Tenant Grid -->
                            <DataGrid x:Name="TenantGrid" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                                      GridLinesVisibility="Horizontal" HeadersVisibility="Column"
                                      BorderThickness="1" BorderBrush="#E0E0E0">
                                <DataGrid.Columns>
                                    <DataGridTemplateColumn Header="" Width="30">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Ellipse Width="12" Height="12" Fill="{Binding StatusColor}"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                    <DataGridTextColumn Header="Tenant Name" Binding="{Binding friendlyName}" Width="*"/>
                                    <DataGridTextColumn Header="Primary Domain" Binding="{Binding primaryDomain}" Width="*"/>
                                    <DataGridTextColumn Header="Users" Binding="{Binding userCount}" Width="80"/>
                                    <DataGridTextColumn Header="Secure Score" Binding="{Binding secureScore}" Width="100"/>
                                    <DataGridTextColumn Header="Last Accessed" Binding="{Binding lastAccessedAt}" Width="150"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                        
                        <!-- Users View (Hidden by default) -->
                        <Grid x:Name="UsersView" Visibility="Collapsed">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>
                            
                            <!-- Search/Filter Bar -->
                            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
                                <TextBox x:Name="UserSearchBox" Width="300" Height="28" Padding="5,3"/>
                                <Button Content="ðŸ” Search" Margin="10,0" Style="{StaticResource PrimaryButton}"/>
                                <CheckBox x:Name="ChkShowGuests" Content="Show Guests" VerticalAlignment="Center" Margin="10,0"/>
                                <CheckBox x:Name="ChkShowDisabled" Content="Show Disabled" VerticalAlignment="Center"/>
                            </StackPanel>
                            
                            <!-- Users Grid -->
                            <DataGrid x:Name="UsersGrid" Grid.Row="1" AutoGenerateColumns="False" IsReadOnly="True"
                                      GridLinesVisibility="Horizontal" HeadersVisibility="Column">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Display Name" Binding="{Binding displayName}" Width="*"/>
                                    <DataGridTextColumn Header="UPN" Binding="{Binding userPrincipalName}" Width="*"/>
                                    <DataGridCheckBoxColumn Header="Enabled" Binding="{Binding accountEnabled}" Width="70"/>
                                    <DataGridTextColumn Header="Licenses" Binding="{Binding licenseCount}" Width="80"/>
                                    <DataGridTextColumn Header="Last Sign-In" Binding="{Binding lastSignIn}" Width="150"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                        
                        <!-- Placeholder for other views -->
                        <Grid x:Name="PlaceholderView" Visibility="Collapsed">
                            <TextBlock x:Name="PlaceholderText" Text="Select an item from the navigation" 
                                       HorizontalAlignment="Center" VerticalAlignment="Center"
                                       FontSize="18" Foreground="Gray"/>
                        </Grid>
                    </Grid>
                </DockPanel>
            </Border>
        </Grid>
    </DockPanel>
</Window>
